<div class="articlebox" title="{{ pluginName }}">
    <p>
        <a data-article-number="{{ article.getArticleNumber() }}" data-article-language="{{article.getLanguageId() }}" class="ui-state-default icon-button js-clear-article-facebook-cache" href="#"><span class="ui-icon ui-icon-pencil"></span>{{ getGS('Clear article cache in Facebook') }}</a>
    </p>
    <div style="clear:both"></div>
    <pre class="article-status"></pre>
    <div class="article-data">
        <h4>{{ getGS('Article data:') }}</h4>
        <ul class="block-list">
            <li>
                <div class="image-thumbnail-container">
                    <img id="fb-picture" style="width: 90%;">
                </div>
                <strong>{{ getGS('Title') }}:</strong> <span><small></small><span><br>
                <strong>{{ getGS('Description') }}:</strong> <span><small id="fb-description"></small></span><br>
            </li>
        </ul>
    </div>
</div>

<script>
$(document).ready(function() {
    var url1 = '/admin/ahs/facebook-plugin/index/' + $('.js-clear-article-facebook-cache').data('articleNumber');
    var url2 = "/admin/ahs/facebook-plugin/clear-cache";
    ajaxFB(url2);
    $('.js-clear-article-facebook-cache').click(function(e){
        e.preventDefault(); 
        ajaxFB(url1);
    });
    function ajaxFB(u) {
        $('pre.article-status').html("{{ getGS('Connecting...') }}");
        var element = $('.js-clear-article-facebook-cache');
        alert(u);
        $.ajax({
            url: u,
            type: "POST",
            data: {
                articleNumber: element.data('articleNumber'),
                languageId: element.data('articleLanguage')
            },
            dataType: "json"
        }).done(function(res){
            if (res.status == false) {
                $('pre.article-status').html('<span style=\"color: #FF2200\">res.message</span>');
            } else {
                $('#fb-picture').attr('src', res.url);
                $('.article-data ul li span small').html(res.title);
                $('#fb-description').html(res.description);
                $('.article-data').show();
                $('pre.article-status').html("<span style=\"color: #11B402\">{{ getGS('Success') }}</span>");
            }
        });
    };
});
</script>